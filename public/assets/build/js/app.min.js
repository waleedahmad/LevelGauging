function attactAddSubmitEvent(a){$("#s-e-r-form").on("click",function(b){var c=$.trim($("#email").val()),d=$.trim($("#status").val()),e=$.trim($("#frequency").val()),f=$.trim($("#timepicker").val()),g=$.trim($("#datepicker").val());if(c.length&&d.length&&e.length&&f.length&&g.length)if(validateEmail(c)){var h=$("meta[name=tankid]").attr("content");alreadyExists(c,a,h)}else $(".reporting-errors").text("Invalid Email.");else console.log("All Fields Required"),$(".reporting-errors").text("All fields required.")})}function validateEmail(a){var b=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return b.test(a)}function alreadyExists(a,b,c){$.ajax({type:"POST",url:"/notifications/verify/email",data:{email:a,type:b,tankid:c},success:function(a){analyizeAlreadyExists(a)}})}function attachInputFieldTimeDateSelectors(){$("#timepicker").timepicker({timeFormat:"h:i A"}),$("#datepicker").datepicker({dateFormat:"yy-mm-dd"})}function analyizeAlreadyExists(a){a.status?$(".reporting-errors").text("Email already exists on list."):$(".report-form > form").submit()}function addOverlayCloseEvent(){$(".overlays > .form > .close").on("click",function(a){$(".overlays").fadeOut("fast",function(a){$(this).remove()})})}function getNotificationEmailFormButton(a,b){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="s-e-r-form" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 80.8 27.7" enable-background="new 0 0 80.8 27.7" xml:space="preserve"><g><rect x="0.5" y="0.4" fill="'+a+'" stroke="#F3F8F9" stroke-miterlimit="10" width="80.3" height="27.2"/><g><rect x="28.6" y="9.8" fill="none" width="68.2" height="29.8"/><text transform="matrix(1 0 0 1 28.5552 17.8945)" fill="#FFFFFF" font-size="12.1205">'+b+'</text></g><polygon fill="#FFFFFF" points="19.7,14.3 15.4,16.7 11,19.1 11,14.3 11,9.5 15.4,11.9 	"/></g></svg>'}function attactUpdateSubmitEvent(a){$("#s-e-r-form").on("click",function(b){var c=$.trim($("#email").val()),d=$.trim($("#email").attr("data-oldmail")),e=$.trim($("#status").val()),f=$.trim($("#frequency").val()),g=$.trim($("#timepicker").val()),h=$.trim($("#datepicker").val());if(c.length&&e.length&&f.length&&g.length&&h.length)if(validateEmail(c))if(c!=d){var i=$("meta[name=tankid]").attr("content");alreadyExists(c,a,i)}else $(".report-form > form").submit();else $(".reporting-errors").text("Invalid Email.");else console.log("All Fields Required"),$(".reporting-errors").text("All fields required.")})}function getNotificationDetails(a){$.ajax({type:"POST",url:"/notifications/details/email",data:{id:a},success:function(a){setFieldsFromResponse(a)}})}function setFieldsFromResponse(a){$("#status").val(a.active),$("#frequency").val(a.frequency),$("#email").val(a.email),$("#email").attr("data-oldmail",a.email),$("#timepicker").val(a.time),$("#datepicker").val(a.date)}$(".global").length&&setTimeout(function(){$(".global").fadeOut("slow")},3e3),$(".global .close").on("click",function(){$(".global").fadeOut("slow")}),$("#add-reporting-email , #add-levelalert-email , #add-inspectdue-email").on("click",function(a){var b=$("meta[name=tankid]").attr("content"),c=$(this).attr("data-name"),d="";switch(console.log(c),c){case"reporting":color="#839D3C",d="Email Reporting - Add";break;case"levels":color="#839D3C",d="Level alert - Add";break;case"inspection":color="#1376A1",d="Tank Inspection - Add"}var e='<div class="overlays"><div class="form '+c+'"><span class="close">X</span><h2>'+d+'</h2><div class="report-form"><form method="post" action="/notifications/add/email"><table class="upper"><tr><td class="spec">Email : </td><td><input type="email" name="email" id="email" placeholder="email" required></td></tr><tr><td class="spec">Status : </td><td><select name="status" id="status" required><option value="1">Active</option><option value="0">Disabled</option></select></td></tr><tr><td class="spec">Frequency : </td><td><select name="frequency" id="frequency" required><option value="daily">Daily report</option><option value="weekly">Weekly report</option><option value="monthly">Monthly report</option></select></td></tr></table><div class="bottom '+c+'"><p>Set start time and date to receive your reporting data </p><table><tr><td class="spec">Time : </td><td><input type="text" name="time" id="timepicker" placeholder="Pick Time" required></p></td></tr><tr><td class="spec">Start Date : </td><td><input type="text" name="date" id="datepicker" placeholder="Pick Date" required></p></td></tr></table></div><div class="reporting-errors"></div>'+getNotificationEmailFormButton(color,"Add")+'<input type="hidden" name="tankid" value="'+b+'"><input type="hidden" name="type" value="'+c+'"></form></div></div></div>';$(e).hide().appendTo(".wrapper").fadeIn("fast"),addOverlayCloseEvent(),attachInputFieldTimeDateSelectors(),attactAddSubmitEvent(c)}),$(".edit-notifications").on("click",function(){var a=$(this),b=$(a).attr("data-id"),c=$(this).attr("data-name"),d=$("meta[name=tankid]").attr("content"),e="";switch(c){case"reporting":color="#839D3C",e="Email Reporting - Edit";break;case"levels":color="#839D3C",e="Level alert - Edit";break;case"inspection":color="#1376A1",e="Tank Inspection - Edit"}var f='<div class="overlays"><div class="form '+c+'"><span class="close">X</span><h2>'+e+'</h2><div class="report-form"><form method="post" action="/notifications/update/email"><table class="upper"><tr><td class="spec">Email : </td><td><input type="email" name="email" data-oldmail="" id="email" placeholder="email" required></td></tr><tr><td class="spec">Status : </td><td><select name="status" id="status" required><option value="1">Active</option><option value="0">Disabled</option></select></td></tr><tr><td class="spec">Frequency : </td><td><select name="frequency" id="frequency" required><option value="daily">Daily report</option><option value="weekly">Weekly report</option><option value="monthly">Monthly report</option></select></td></tr></table><div class="bottom '+c+'"><p>Set start time and date to receive your reporting data </p><table><tr><td class="spec">Time : </td><td><input type="text" name="time" id="timepicker" placeholder="Pick Time" required></p></td></tr><tr><td class="spec">Start Date : </td><td><input type="text" name="date" id="datepicker" placeholder="Pick Date" required></p></td></tr></table></div><div class="reporting-errors"></div>'+getNotificationEmailFormButton(color,"Update")+'<input type="hidden" name="id" value="'+b+'"><input type="hidden" name="tankid" value="'+d+'"><input type="hidden" name="type" value="'+c+'"></form></div></div></div>';$(f).hide().appendTo(".wrapper").fadeIn("fast"),addOverlayCloseEvent(),getNotificationDetails(b),attachInputFieldTimeDateSelectors(),attactUpdateSubmitEvent(c)}),$(".remove-notifications").on("click",function(){var a=$(this),b=$(a).attr("data-id");$.ajax({type:"POST",url:"/notifications/delete/email",data:{id:b},success:function(b){b.status&&$(a).parents("li").slideUp("slow")}})});var $report_upload=$(".client-details > .content > .content-blocks > .bottom > .right");$($report_upload).children(".report-upload").on("click",function(){$target=$(this),$($target).parents(".right").css({top:0,right:0,bottom:0,left:0,margin:"auto",position:"absolute","-webkit-box-shadow":"0px 0px 20px 0px rgba(0,0,0,0.75)","-moz-box-shadow":"0px 0px 20px 0px rgba(0,0,0,0.75)","box-shadow":"0px 0px 20px 0px rgba(0,0,0,0.75)"}).animate({height:"400px",width:"600px"},"slow"),$($target).parents(".right").children(".files").animate({height:"260px"}),$($target).parents(".right").children(".files").children(".file").children(".remove").show(),$($target).hide(),$($target).parents(".right").children(".close").show(),$($target).parents(".right").children(".upload").show()}),$($report_upload).children(".close").on("click",function(a){$target=$(this),$($target).parents(".right").animate({height:"100%",width:"35%"}).hide("fast").css({position:"relative",display:"none","-webkit-box-shadow":"none","-moz-box-shadow":"none","box-shadow":"none"}).fadeIn("fast"),$($target).parents(".right").children(".files").animate({height:"145px"}),$($target).parents(".right").children(".files").children(".file").children(".remove").hide(),$($target).hide(),$($target).parents(".right").children(".report-upload").show(),$($target).parents(".right").children(".upload").hide()}),$("#file-upload").change(function(){var a=this.value,b=a.match(/([^\/\\]+)$/),c=b[1];$("#filename").html(c),$(".history-form").submit()}),$($report_upload).find(".files > .file > .remove > .delete").on("click",function(){var a=$(this),b=$(a).attr("data-id");$.ajax({type:"POST",url:"/delete/history",data:{id:b},success:function(b){b.status&&$(a).parents(".file").slideUp("slow")}})});