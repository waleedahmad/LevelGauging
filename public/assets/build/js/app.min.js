function newTankContact(a){var b=$("meta[name=tankid]").attr("content"),c='<div class="overlays"><div class="addcontactform"><span class="close">X</span><h2>Contacts - Add</h2><div class="contact-form"><form method="post" action="/contacts/add"><table><tr class="theader"><td class="spec">Title Header :  </td><td><input type="text" name="title" id="title" placeholder="contact title" required></td></tr><tr><td class="spec">Name : </td><td><input type="text" name="name" id="name" placeholder="full name" required></td></tr><tr><td class="spec">Job title : </td><td><input type="text" name="job-title" id="job-title" placeholder="job title" required></td></tr><tr><td class="spec">Company : </td><td><input type="text" name="company" id="company" placeholder="company name" required></td></tr><tr><td class="spec">Telephone 1 : </td><td><input type="text" name="phone1" id="phone1" placeholder="phone" required></td></tr><tr><td class="spec">Telephone 2 : </td><td><input type="text" name="phone2" id="phone2" placeholder="phone" required></td></tr><tr><td class="spec">Email : </td><td><input type="email" name="email" id="email" placeholder="email" required></td></tr></table>'+getContactAddButton("Add")+'<div class="contact-errors"></div><input type="hidden" name="tankid" value="'+b+'"></form></div></div></div>';$(c).hide().appendTo(".wrapper").fadeIn("fast"),addContactsOverlayCloseEvent(),attactContactFormSubmitEvent()}function attactContactFormSubmitEvent(){$("#s-c-form").on("click",function(a){var b=$.trim($("#title").val()),c=$.trim($("#name").val()),d=$.trim($("#job-title").val()),e=$.trim($("#company").val()),f=$.trim($("#phone1").val()),g=($.trim($("#phone2").val()),$.trim($("#email").val()));b.length&&c.length&&d.length&&e.length&&f.length&&g.length?$(".contact-form > form").submit():(console.log("All Fields Required"),$(".contact-errors").text("All fields required."))})}function addContactsOverlayCloseEvent(){$(".overlays > .addcontactform > .close").on("click",function(a){$(".overlays").fadeOut("fast",function(a){$(this).remove()})})}function getContactAddButton(a){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="s-c-form" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 80.8 27.7" enable-background="new 0 0 80.8 27.7" xml:space="preserve"><g><rect x="0.5" y="0.4" fill="#839D3C" stroke="#F3F8F9" stroke-miterlimit="10" width="80.3" height="27.2"/><g><rect x="28.6" y="9.8" fill="none" width="68.2" height="29.8"/><text transform="matrix(1 0 0 1 28.5552 17.8945)" fill="#FFFFFF" font-size="12.1205">'+a+'</text></g><polygon fill="#FFFFFF" points="19.7,14.3 15.4,16.7 11,19.1 11,14.3 11,9.5 15.4,11.9 	"/></g></svg>'}function removeTankContact(){var a=$(this).attr("data-id"),b='<div class="overlays"><div class="confirm-remove"><span class="close">X</span><h2>Contacts - Remove</h2><div class="dialogue"><div class="left"><p>Are you sure you want to remove contact from this list</p></div><div class="right">'+getContactDeleteAddButton("Update",a)+"</div><div></div></div>";$(b).hide().appendTo(".wrapper").fadeIn("fast"),addContactsRemoveOverlayCloseEvent(),addContactRemoveSubmitEvent()}function addContactsRemoveOverlayCloseEvent(){$(".overlays > .confirm-remove > .close").on("click",function(a){$(".overlays").fadeOut("fast",function(a){$(this).remove()})}),removeEditRemoveButtonEvents()}function addContactRemoveSubmitEvent(){$("#d-c-form").on("click",function(){var a=$(this),b=$(a).attr("data-id");$.ajax({type:"POST",url:"/contacts/delete",data:{id:b},success:function(a){a.status&&location.reload(!0)}})})}function editTankContact(){var a=$("meta[name=tankid]").attr("content"),b=$(this).attr("data-id"),c='<div class="overlays"><div class="addcontactform"><span class="close">X</span><h2>Contacts - Add</h2><div class="contact-form"><form method="post" action="/contacts/update"><table><tr class="theader"><td class="spec">Title Header :  </td><td><input type="text" name="title" id="title" placeholder="contact title" required></td></tr><tr><td class="spec">Name : </td><td><input type="text" name="name" id="name" placeholder="full name" required></td></tr><tr><td class="spec">Job title : </td><td><input type="text" name="job-title" id="job-title" placeholder="job title" required></td></tr><tr><td class="spec">Company : </td><td><input type="text" name="company" id="company" placeholder="company name" required></td></tr><tr><td class="spec">Telephone 1 : </td><td><input type="text" name="phone1" id="phone1" placeholder="phone" required></td></tr><tr><td class="spec">Telephone 2 : </td><td><input type="text" name="phone2" id="phone2" placeholder="phone" required></td></tr><tr><td class="spec">Email : </td><td><input type="email" name="email" id="email" placeholder="email" required></td></tr></table>'+getContactAddButton("Update")+'<div class="contact-errors"></div><input type="hidden" name="tankid" value="'+a+'"><input type="hidden" name="id" value="'+b+'"></form></div></div></div>';$(c).hide().appendTo(".wrapper").fadeIn("fast"),addContactsEditOverlayCloseEvent(),attactContactFormSubmitEvent(),getDetailsAndFillContactFields(b)}function getDetailsAndFillContactFields(a){$.ajax({type:"POST",url:"/contacts/details",data:{id:a},success:function(a){handleContactFieldsResponse(a)}})}function handleContactFieldsResponse(a){$("#title").val(a.title),$("#name").val(a.name),$("#job-title").val(a.job_title),$("#company").val(a.company),$("#phone1").val(a.telephone_1),$("#phone2").val(a.telephone_2),$("#email").val(a.email),$("#email").val(a.email)}function addContactsEditOverlayCloseEvent(){$(".overlays > .addcontactform > .close").on("click",function(a){$(".overlays").fadeOut("fast",function(a){$(this).remove()})}),removeEditRemoveButtonEvents()}function removeEditRemoveButtonEvents(){$(".contact-checkbox").prop("checked",!1),$("#edit-contact").unbind("click",editTankContact),$("#remove-contact").unbind("click",removeTankContact),$("#edit-contact, #remove-contact").css({cursor:"not-allowed"})}function getContactDeleteAddButton(a,b){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="d-c-form" data-id="'+b+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 80.8 27.7" enable-background="new 0 0 80.8 27.7" xml:space="preserve"><g><rect x="0.5" y="0.4" fill="#839D3C" stroke="#F3F8F9" stroke-miterlimit="10" width="80.3" height="27.2"/><g><rect x="28.6" y="9.8" fill="none" width="68.2" height="29.8"/><text transform="matrix(1 0 0 1 28.5552 17.8945)" fill="#FFFFFF" font-size="12.1205">'+a+'</text></g><polygon fill="#FFFFFF" points="19.7,14.3 15.4,16.7 11,19.1 11,14.3 11,9.5 15.4,11.9 	"/></g></svg>'}function getInspectionEditButton(a,b){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="t-i-form" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 80.8 27.7" enable-background="new 0 0 80.8 27.7" xml:space="preserve"><g><rect x="0.5" y="0.4" fill="'+a+'" stroke="#F3F8F9" stroke-miterlimit="10" width="80.3" height="27.2"/><g><rect x="28.6" y="9.8" fill="none" width="68.2" height="29.8"/><text transform="matrix(1 0 0 1 28.5552 17.8945)" fill="#FFFFFF" font-size="12.1205">'+b+'</text></g><polygon fill="#FFFFFF" points="19.7,14.3 15.4,16.7 11,19.1 11,14.3 11,9.5 15.4,11.9 	"/></g></svg>'}function addInspectEditOverlayCloseEvent(){$(".overlays > .editinspection > .close").on("click",function(a){$(".overlays").fadeOut("fast",function(a){$(this).remove()})})}function date_time_inspection_datepickers(){$("#date-inspected,#date-cleaned, #next-inspection").datepicker({dateFormat:"yy-mm-dd"})}function attactInspectionEditSubmit(){$("#t-i-form").on("click",function(a){var b=$.trim($("#contractor").val()),c=$.trim($("#telephone").val()),d=$.trim($("#email").val()),e=$.trim($("#date-inspected").val()),f=$.trim($("#date-cleaned").val()),g=$.trim($("#next-inspection").val());if(b.length&&c.length&&d.length&&e.length&&f.length&&g.length)if(validateEmail(d)){$("meta[name=tankid]").attr("content");$(".inspection-form > form").submit()}else $(".reporting-errors").text("Invalid Email.");else console.log("All Fields Required"),$(".reporting-errors").text("All fields required.")})}function fillInspectionDetailFields(a){$.ajax({type:"POST",url:"/inspection/details",data:{tankid:a},success:function(a){fillInspectionFormWithResponse(a)}})}function fillInspectionFormWithResponse(a){$("#contractor").val(a.contractor),$("#telephone").val(a.phone),$("#email").val(a.email),$("#date-inspected").val(a.date_inspected),$("#date-cleaned").val(a.date_cleaned),$("#next-inspection").val(a.next_inspection)}function attactAddSubmitEvent(a){$("#s-e-r-form").on("click",function(b){var c=$.trim($("#email").val()),d=$.trim($("#status").val()),e=$.trim($("#frequency").val()),f=$.trim($("#timepicker").val()),g=$.trim($("#datepicker").val());if(c.length&&d.length&&e.length&&f.length&&g.length)if(validateEmail(c)){var h=$("meta[name=tankid]").attr("content");alreadyExists(c,a,h)}else $(".reporting-errors").text("Invalid Email.");else console.log("All Fields Required"),$(".reporting-errors").text("All fields required.")})}function validateEmail(a){var b=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return b.test(a)}function alreadyExists(a,b,c){$.ajax({type:"POST",url:"/notifications/verify/email",data:{email:a,type:b,tankid:c},success:function(a){analyizeAlreadyExists(a)}})}function attachInputFieldTimeDateSelectors(){$("#timepicker").timepicker({timeFormat:"h:i A"}),$("#datepicker").datepicker({dateFormat:"yy-mm-dd"})}function analyizeAlreadyExists(a){a.status?$(".reporting-errors").text("Email already exists on list."):$(".report-form > form").submit()}function addOverlayCloseEvent(){$(".overlays > .form > .close").on("click",function(a){$(".overlays").fadeOut("fast",function(a){$(this).remove()})})}function getNotificationEmailFormButton(a,b){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="s-e-r-form" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 80.8 27.7" enable-background="new 0 0 80.8 27.7" xml:space="preserve"><g><rect x="0.5" y="0.4" fill="'+a+'" stroke="#F3F8F9" stroke-miterlimit="10" width="80.3" height="27.2"/><g><rect x="28.6" y="9.8" fill="none" width="68.2" height="29.8"/><text transform="matrix(1 0 0 1 28.5552 17.8945)" fill="#FFFFFF" font-size="12.1205">'+b+'</text></g><polygon fill="#FFFFFF" points="19.7,14.3 15.4,16.7 11,19.1 11,14.3 11,9.5 15.4,11.9 	"/></g></svg>'}function attactUpdateSubmitEvent(a){$("#s-e-r-form").on("click",function(b){var c=$.trim($("#email").val()),d=$.trim($("#email").attr("data-oldmail")),e=$.trim($("#status").val()),f=$.trim($("#frequency").val()),g=$.trim($("#timepicker").val()),h=$.trim($("#datepicker").val());if(c.length&&e.length&&f.length&&g.length&&h.length)if(validateEmail(c))if(c!=d){var i=$("meta[name=tankid]").attr("content");alreadyExists(c,a,i)}else $(".report-form > form").submit();else $(".reporting-errors").text("Invalid Email.");else console.log("All Fields Required"),$(".reporting-errors").text("All fields required.")})}function getNotificationDetails(a){$.ajax({type:"POST",url:"/notifications/details/email",data:{id:a},success:function(a){setFieldsFromResponse(a)}})}function setFieldsFromResponse(a){$("#status").val(a.active),$("#frequency").val(a.frequency),$("#email").val(a.email),$("#email").attr("data-oldmail",a.email),$("#timepicker").val(a.time),$("#datepicker").val(a.date)}var contact_count=$(".address-list").find(".address").length;contact_count>8?$("#add-contact").css({cursor:"not-allowed"}):$("#add-contact").on("click",newTankContact),$(".contact-checkbox").on("click",function(a){var b=$(this),c=$(b).attr("data-id");$(".contact-checkbox").not(b).prop("checked",!1),$(".contact-checkbox:checked").length?($("#edit-contact, #remove-contact").css({cursor:"pointer"}),$("#edit-contact").attr("data-id",c),$("#remove-contact").attr("data-id",c),$("#edit-contact").on("click",editTankContact),$("#remove-contact").on("click",removeTankContact)):($("#edit-contact, #remove-contact").css({cursor:"not-allowed"}),$("#edit-contact").attr("data-id",""),$("#remove-contact").attr("data-id",""),$("#edit-contact").unbind("click",editTankContact),$("#remove-contact").unbind("click",removeTankContact))}),$("#datefrom").datepicker({dateFormat:"yy-mm-dd"}),$("#dateto").datepicker({dateFormat:"yy-mm-dd"}),$(".edit-tank-inspection").on("click",function(){var a=$(this),b=$(a).attr("data-tankid"),c='<div class="overlays"><div class="editinspection"><span class="close">X</span><h2>Tank Inspection - Edit</h2><div class="inspection-form"><form method="post" action="/inspection/edit"><table class="upper"><tr><td class="spec">Contractor : </td><td><input type="text" name="contractor" id="contractor" placeholder="Contractor name" required></td></tr><tr><td class="spec">Telephone : </td><td><input type="text" name="telephone" id="telephone" placeholder="Telephone number" required></td></tr><tr><td class="spec">Email : </td><td><input type="email" name="email" id="email" placeholder="email" required></td></tr></table><div class="bottom"><table><tr><td class="spec">Date Inspected : </td><td><input type="text" name="d-inspected" id="date-inspected" placeholder="Date Inspected" required></p></td></tr><tr><td class="spec">Date Cleaned : </td><td><input type="text" name="d-cleaned" id="date-cleaned" placeholder="Date Cleaned" required></p></td></tr><tr class="last"><td class="spec">Next Inspection Due : </td><td><input type="text" name="d-next-inspection" id="next-inspection" placeholder="Next Inspection Date" required></p></td></tr></table></div>'+getInspectionEditButton("#1376A1","Update")+'<div class="reporting-errors"></div><input type="hidden" name="tankid" value="'+b+'"></form></div></div></div>';$(c).hide().appendTo(".wrapper").fadeIn("fast"),addInspectEditOverlayCloseEvent(),date_time_inspection_datepickers(),attactInspectionEditSubmit(),fillInspectionDetailFields(b)}),$(".global").length&&setTimeout(function(){$(".global").fadeOut("slow")},3e3),$(".global .close").on("click",function(){$(".global").fadeOut("slow")}),$("#add-reporting-email , #add-levelalert-email , #add-inspectdue-email").on("click",function(a){var b=$("meta[name=tankid]").attr("content"),c=$(this).attr("data-name"),d="";switch(console.log(c),c){case"reporting":color="#839D3C",d="Email Reporting - Add";break;case"levels":color="#839D3C",d="Level alert - Add";break;case"inspection":color="#1376A1",d="Tank Inspection - Add"}var e='<div class="overlays"><div class="form '+c+'"><span class="close">X</span><h2>'+d+'</h2><div class="report-form"><form method="post" action="/notifications/add/email"><table class="upper"><tr><td class="spec">Email : </td><td><input type="email" name="email" id="email" placeholder="email" required></td></tr><tr><td class="spec">Status : </td><td><select name="status" id="status" required><option value="1">Active</option><option value="0">Disabled</option></select></td></tr><tr><td class="spec">Frequency : </td><td><select name="frequency" id="frequency" required><option value="daily">Daily report</option><option value="weekly">Weekly report</option><option value="monthly">Monthly report</option></select></td></tr></table><div class="bottom '+c+'"><p>Set start time and date to receive your reporting data </p><table><tr><td class="spec">Time : </td><td><input type="text" name="time" id="timepicker" placeholder="Pick Time" required></p></td></tr><tr><td class="spec">Start Date : </td><td><input type="text" name="date" id="datepicker" placeholder="Pick Date" required></p></td></tr></table></div><div class="reporting-errors"></div>'+getNotificationEmailFormButton(color,"Add")+'<input type="hidden" name="tankid" value="'+b+'"><input type="hidden" name="type" value="'+c+'"></form></div></div></div>';$(e).hide().appendTo(".wrapper").fadeIn("fast"),addOverlayCloseEvent(),attachInputFieldTimeDateSelectors(),attactAddSubmitEvent(c)}),$(".edit-notifications").on("click",function(){var a=$(this),b=$(a).attr("data-id"),c=$(this).attr("data-name"),d=$("meta[name=tankid]").attr("content"),e="";switch(c){case"reporting":color="#839D3C",e="Email Reporting - Edit";break;case"levels":color="#839D3C",e="Level alert - Edit";break;case"inspection":color="#1376A1",e="Tank Inspection - Edit"}var f='<div class="overlays"><div class="form '+c+'"><span class="close">X</span><h2>'+e+'</h2><div class="report-form"><form method="post" action="/notifications/update/email"><table class="upper"><tr><td class="spec">Email : </td><td><input type="email" name="email" data-oldmail="" id="email" placeholder="email" required></td></tr><tr><td class="spec">Status : </td><td><select name="status" id="status" required><option value="1">Active</option><option value="0">Disabled</option></select></td></tr><tr><td class="spec">Frequency : </td><td><select name="frequency" id="frequency" required><option value="daily">Daily report</option><option value="weekly">Weekly report</option><option value="monthly">Monthly report</option></select></td></tr></table><div class="bottom '+c+'"><p>Set start time and date to receive your reporting data </p><table><tr><td class="spec">Time : </td><td><input type="text" name="time" id="timepicker" placeholder="Pick Time" required></p></td></tr><tr><td class="spec">Start Date : </td><td><input type="text" name="date" id="datepicker" placeholder="Pick Date" required></p></td></tr></table></div><div class="reporting-errors"></div>'+getNotificationEmailFormButton(color,"Update")+'<input type="hidden" name="id" value="'+b+'"><input type="hidden" name="tankid" value="'+d+'"><input type="hidden" name="type" value="'+c+'"></form></div></div></div>';$(f).hide().appendTo(".wrapper").fadeIn("fast"),addOverlayCloseEvent(),getNotificationDetails(b),attachInputFieldTimeDateSelectors(),attactUpdateSubmitEvent(c)}),$(".remove-notifications").on("click",function(){var a=$(this),b=$(a).attr("data-id");$.ajax({type:"POST",url:"/notifications/delete/email",data:{id:b},success:function(b){b.status&&$(a).parents("li").slideUp("slow")}})});var $report_upload=$(".client-details > .content > .content-blocks > .bottom > .right");$($report_upload).children(".report-upload").on("click",function(){$target=$(this),$($target).parents(".right").css({top:0,right:0,bottom:0,left:0,margin:"auto",position:"absolute","-webkit-box-shadow":"0px 0px 20px 0px rgba(0,0,0,0.75)","-moz-box-shadow":"0px 0px 20px 0px rgba(0,0,0,0.75)","box-shadow":"0px 0px 20px 0px rgba(0,0,0,0.75)"}).animate({height:"400px",width:"600px"},"slow"),$($target).parents(".right").children(".files").animate({height:"260px"}),$($target).parents(".right").children(".files").children(".file").children(".remove").show(),$($target).hide(),$($target).parents(".right").children(".close").show(),$($target).parents(".right").children(".upload").show()}),$($report_upload).children(".close").on("click",function(a){$target=$(this),$($target).parents(".right").animate({height:"100%",width:"35%"}).hide("fast").css({position:"relative",display:"none","-webkit-box-shadow":"none","-moz-box-shadow":"none","box-shadow":"none"}).fadeIn("fast"),$($target).parents(".right").children(".files").animate({height:"145px"}),$($target).parents(".right").children(".files").children(".file").children(".remove").hide(),$($target).hide(),$($target).parents(".right").children(".report-upload").show(),$($target).parents(".right").children(".upload").hide()}),$("#file-upload").change(function(){var a=this.value,b=a.match(/([^\/\\]+)$/),c=b[1];$("#filename").html(c),$(".history-form").submit()}),$($report_upload).find(".files > .file > .remove > .delete").on("click",function(){var a=$(this),b=$(a).attr("data-id");$.ajax({type:"POST",url:"/delete/history",data:{id:b},success:function(b){b.status&&$(a).parents(".file").slideUp("slow")}})});